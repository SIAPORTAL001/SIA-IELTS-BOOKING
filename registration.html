<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SIA Candidate Registration</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>

<section class="registration-form">

  <!-- LOGO -->
  <img src="images/logo.png" class="form-logo">

  <!-- HEADING -->
  <h1>
    Welcome to <br>
    <strong>New SIA Candidate Registration Form</strong>
  </h1>

  <!-- FORM -->
  <form id="candidateForm" onsubmit="return false;">

    <input type="text" id="studentName" placeholder="Student Name" required>
    <input type="text" id="parentName" placeholder="Parents Name" required>
    <input type="text" id="cnic" placeholder="CNIC No" required>
    <input type="text" id="address" placeholder="Address" required>
    <input type="text" id="phone" placeholder="Phone No" required>
    <input type="text" id="courseName" placeholder="Course Name" required>
    <input type="text" id="courseCode" placeholder="Course Code" required>
    <input type="text" id="coursePurpose" placeholder="Course Purpose" required>

    <button type="button" onclick="generatePDF()">
      Generate PDF Form
    </button>

  </form>

  <hr style="margin:30px 0">

  <!-- CHECK SECTION -->
  <h2>Check Candidate Registration</h2>

  <input type="text" id="searchCnic" placeholder="Enter CNIC Number">
  
  <button type="button" onclick="checkCandidate()">
    Check Candidate Detail
  </button>

  <button type="button" onclick="deleteCandidate()" style="background:red;">
    Delete Candidate Data
  </button>

</section>

<!-- ================= PDF + STORAGE SCRIPT ================= -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
/* ===== SAVE DATA ===== */
function saveCandidateData(data) {
  localStorage.setItem("SIA_CANDIDATE_" + data.cnic, JSON.stringify(data));
}

/* ===== GENERATE PDF ===== */
function generatePDF() {

  const data = {
    studentName: studentName.value,
    parentName: parentName.value,
    cnic: cnic.value,
    address: address.value,
    phone: phone.value,
    courseName: courseName.value,
    courseCode: courseCode.value,
    coursePurpose: coursePurpose.value
  };

  if (!data.cnic) {
    alert("CNIC is required");
    return;
  }

  saveCandidateData(data);

  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF();

  const logo = new Image();
  logo.src = "images/logo.png";

  logo.onload = function () {

    pdf.setFillColor(245, 196, 0);
    pdf.rect(0, 0, 210, 40, "F");

    pdf.addImage(logo, "PNG", 85, 8, 40, 20);

    pdf.setFontSize(18);
    pdf.text(
      "Welcome to New SIA Candidate Registration Form",
      105, 55,
      { align: "center" }
    );

    pdf.setFontSize(12);
    let y = 75;

    for (let key in data) {
      pdf.rect(20, y - 6, 170, 10);
      pdf.text(key.replace(/([A-Z])/g, ' $1') + ": " + data[key], 25, y);
      y += 14;
    }

    pdf.save("SIA-Candidate-Registration.pdf");
    alert("PDF generated & data saved ✔");
  };
}

/* ===== CHECK DATA ===== */
function checkCandidate() {
  const cnic = document.getElementById("searchCnic").value;
  const saved = localStorage.getItem("SIA_CANDIDATE_" + cnic);

  if (!saved) {
    alert("No record found");
    return;
  }

  const data = JSON.parse(saved);

  studentName.value = data.studentName;
  parentName.value = data.parentName;
  document.getElementById("cnic").value = data.cnic;
  address.value = data.address;
  phone.value = data.phone;
  courseName.value = data.courseName;
  courseCode.value = data.courseCode;
  coursePurpose.value = data.coursePurpose;

  alert("Candidate data loaded ✔");
}

/* ===== DELETE DATA ===== */
function deleteCandidate() {
  const cnic = document.getElementById("searchCnic").value;

  if (!cnic) {
    alert("Enter CNIC first");
    return;
  }

  localStorage.removeItem("SIA_CANDIDATE_" + cnic);
  alert("Candidate data deleted ❌");
}
</script>

</body>
</html>
