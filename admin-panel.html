<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>

<style>
*{box-sizing:border-box;font-family:Arial,Helvetica,sans-serif}
body{margin:0;background:#f4f4f4}

/* HEADER */
.header{
  background:#000;
  color:#fff;
  text-align:center;
  padding:25px;
  font-size:28px;
  font-weight:bold;
}

/* TOP BUTTONS */
.top-buttons{
  display:flex;
  justify-content:center;
  gap:15px;
  padding:20px;
}
.top-buttons button{
  padding:14px 26px;
  border:none;
  border-radius:30px;
  font-size:15px;
  cursor:pointer;
  font-weight:600;
}
.btn-book{background:#000;color:#fff}
.btn-reg{background:#f5c400}
.btn-update{background:#1976d2;color:#fff}

/* SECTIONS */
.section{display:none;padding:25px}

/* COMMON BOX */
.box{
  background:#fff;
  max-width:900px;
  margin:auto;
  padding:25px;
  border-radius:12px;
}

/* INPUTS */
input,select,textarea{
  width:100%;
  padding:10px;
  border-radius:20px;
  border:1px solid #ccc;
  margin-bottom:12px;
}

/* BUTTON */
.black-btn{
  background:#000;
  color:#fff;
  border:none;
  padding:14px;
  border-radius:30px;
  width:100%;
  font-size:16px;
  cursor:pointer;
}

/* TRF FORM */
.trf{
  border:2px solid #000;
  padding:20px;
}
.trf-top{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.trf-note{font-size:12px;margin:15px 0}
.row{display:flex;gap:10px;flex-wrap:wrap}
.gray{background:#eaeaea}
.photo-box{
  width:150px;
  height:200px;
  border:2px solid #000;
}
hr{margin:20px 0}

/* RESULTS ROW */
.results-row{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}
.results-row input{width:120px}

/* ADMIN COMMENTS */
.square{
  width:180px;
  height:120px;
  border:1px solid #000;
  padding:5px;
}
.comment-box{height:100px}

/* PDF BUTTON */
.pdf-btn{
  margin-top:20px;
  background:#000;
  color:#fff;
  padding:12px 30px;
  border-radius:30px;
  border:none;
  cursor:pointer;
}

/* MOBILE */
@media(max-width:768px){
  .results-row input{width:100%}
}
.photo-box{
  width: 180px;
  height: 220px;
  border: 2px solid #000;
  position: relative;
  cursor: pointer;
  overflow: hidden;
  background: #f5f5f5;
  display: flex;
  align-items: center;
  justify-content: center;
}

.photo-text{
  font-size: 13px;
  color: #444;
  text-align: center;
}

.photo-box video,
.photo-box canvas{
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: none;
}
</style>
</head>

<body>

<div class="header">WELCOME TO THE ADMIN PANEL</div>

<div class="top-buttons">
  <button class="btn-book" onclick="showSection('book')">BOOK TEST</button>
  <button class="btn-reg" onclick="showSection('reg')">Candidate Registration Form</button>
  <button class="btn-update" onclick="showSection('update')">Update Result</button>
</div>

<!-- BOOK TEST -->
<div class="section" id="book">
  <div class="box">
    <h3>Book Test</h3>
    <input placeholder="Candidate Name">
    <input type="email" placeholder="Candidate Email">
    <select>
      <option>Select Test Mode</option>
      <option>IELTS Academic</option>
      <option>IELTS General Training</option>
      <option>IELTS Life Skill</option>
    </select>
    <input type="date" id="testDate">
    <select>
      <option>Select Test Time</option>
      <option>10:00 AM</option><option>11:00 AM</option>
      <option>12:00 PM</option><option>01:00 PM</option>
      <option>02:00 PM</option><option>03:00 PM</option>
      <option>04:00 PM</option>
    </select>
    <button class="black-btn">BOOK TEST</button>
  </div>
</div>

<!-- CANDIDATE REGISTRATION -->
<div class="section" id="reg">
  <div class="box">
    <h3>Welcome to the Candidate Registration Form</h3>

    <div class="trf" id="trfForm">
      <div class="trf-top">
        <div style="width:60%;border:1px solid #000;height:35px"></div>
        <div>
          <b>IELTS<sup>TM</sup></b><br>Test Report Form
        </div>
      </div>

      <p class="trf-note">
        <b>NOTE.</b><br>
        Admission to undergraduate and post graduate courses should be based on the
        <b>ACADEMIC</b> Reading and Writing Modules.<br>
        GENERAL TRAINING modules are not designed for academic purposes.<br>
        Re-assessment recommended after two years.
      </p>

      <div class="row">
        Centre Number:<input value="PK361" readonly>
        Date:<input>
        Candidate Number:
      <input id="candidateNumber">
      </div>

      <hr>

      <h4>Candidate Details</h4>
      <div class="row">
        <div style="flex:1">
          Family Name:<input class="gray">
          First Name:<input class="gray">
          Candidate ID:<input class="gray">
        </div>
      <div class="photo-box" id="photoBox">
  <span class="photo-text">Tap to Capture Photo</span>

  <video id="video" autoplay playsinline></video>
  <canvas id="canvas"></canvas>
</div>

      <hr>

      <div class="row">
        Date of Birth:<input>
        Sex:<input style="width:60px">
        Scheme Code:<input>
      </div>
      Country/Region:<input>
      Nationality:<input>
      First Language:<input>

      <hr>

      <h4>Test Results</h4>
      <div class="results-row">
        Listening<input class="gray">
        Reading<input class="gray">
        Writing<input class="gray">
        Speaking<input class="gray">
        Overall<input class="gray">
        CEFR<input class="gray">
      </div>

      <hr>

      <h4>Administrator Comments</h4>
      <textarea class="comment-box"></textarea>

      <div class="row">
        <div class="square">Recognising organisations must verify this score at ielts.org/verify</div>
        <div class="square">Validation Stamp</div>
      </div>

      <div class="row">
        TRF Number:
<input
  id="trfNumber"
  class="gray"
  readonly
>
      </div>
    </div>

    <button onclick="generatePDF()" class="black-btn">
  Generate TRF PDF
</button>
  </div>
</div>

<!-- UPDATE RESULT -->
<div class="section" id="update">
  <div class="box">
    <h3>Update Result</h3>
    <input placeholder="Listening">
    <input placeholder="Reading">
    <input placeholder="Writing">
    <input placeholder="Speaking">
    <input placeholder="Overall Band Score">
    <input placeholder="CEFR Level">
    <label>Upload TRF PDF</label>
    <input type="file" accept="application/pdf">
    <button class="black-btn">Upload Result</button>
  </div>
</div>

<script>
function showSection(id){
  document.querySelectorAll('.section').forEach(s=>s.style.display='none');
  document.getElementById(id).style.display='block';
}
showSection('book');

/* Disable Fri Sat Sun */
document.getElementById("testDate").addEventListener("input",e=>{
  const d=new Date(e.target.value).getDay();
  if(d==5||d==6||d==0){
    alert("Friday, Saturday and Sunday not allowed");
    e.target.value="";
  }
});

const photoBox = document.getElementById("photoBox");
const video = document.getElementById("video");
const canvas = document.getElementById("canvas");
const text = document.querySelector(".photo-text");

let stream = null;
let photoTaken = false;

photoBox.addEventListener("click", async () => {

  // FIRST TAP → CAMERA OPEN
  if (!stream) {
    try {
      stream = await navigator.mediaDevices.getUserMedia({
        video: { facingMode: "user" }
      });

      video.srcObject = stream;
      video.style.display = "block";
      text.style.display = "none";
    } catch (err) {
      alert("Camera permission denied");
    }
    return;
  }

  // SECOND TAP → PHOTO CAPTURE
  if (!photoTaken) {
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    canvas.getContext("2d").drawImage(video, 0, 0);

    video.style.display = "none";
    canvas.style.display = "block";

    stream.getTracks().forEach(track => track.stop());
    stream = null;
    photoTaken = true;
  }
});
  src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<script>
function generatePDF() {
  const element = document.getElementById("trfForm");

  if (!element) {
    alert("TRF Form not found!");
    return;
  }

  const options = {
    margin: 0,
    filename: 'IELTS_TRF_Report.pdf',
    image: { type: 'jpeg', quality: 1 },
    html2canvas: {
      scale: 3,
      useCORS: true
    },
    jsPDF: {
      unit: 'mm',
      format: 'a4',
      orientation: 'portrait'
    }
  };

  html2pdf().set(options).from(element).save();
}
</script>
</body>
</html>